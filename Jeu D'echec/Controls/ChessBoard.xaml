<?xml version="1.0" encoding="utf-8"?>
<UserControl
    x:Class="Jeu_D_echec.Controls.ChessBoard"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Jeu_D_echec.Controls"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <UserControl.Resources>
        <SolidColorBrush x:Key="LightSquareBrush" Color="#F0D9B5"/>
        <SolidColorBrush x:Key="DarkSquareBrush" Color="#B58863"/>
        
        <!-- Move animation -->
        <Storyboard x:Name="MoveAnimation">
            <DoubleAnimation x:Name="MoveXAnimation"
                           Duration="0:0:0.4"
                           EasingFunction="{StaticResource MoveEasing}"/>
            <DoubleAnimation x:Name="MoveYAnimation"
                           Duration="0:0:0.4"
                           EasingFunction="{StaticResource MoveEasing}"/>
            <DoubleAnimation x:Name="MoveScaleAnimation"
                           Storyboard.TargetProperty="(UIElement.RenderTransform).(CompositeTransform.ScaleX)"
                           From="1.0"
                           To="1.1"
                           Duration="0:0:0.2"
                           AutoReverse="True"/>
            <DoubleAnimation x:Name="MoveScaleYAnimation"
                           Storyboard.TargetProperty="(UIElement.RenderTransform).(CompositeTransform.ScaleY)"
                           From="1.0"
                           To="1.1"
                           Duration="0:0:0.2"
                           AutoReverse="True"/>
        </Storyboard>

        <!-- Capture animation -->
        <Storyboard x:Name="CaptureAnimation">
            <DoubleAnimation x:Name="CaptureScaleAnimation"
                           Storyboard.TargetProperty="(UIElement.RenderTransform).(CompositeTransform.ScaleX)"
                           From="1.0"
                           To="0.0"
                           Duration="0:0:0.3"
                           EasingFunction="{StaticResource CaptureEasing}"/>
            <DoubleAnimation x:Name="CaptureScaleYAnimation"
                           Storyboard.TargetProperty="(UIElement.RenderTransform).(CompositeTransform.ScaleY)"
                           From="1.0"
                           To="0.0"
                           Duration="0:0:0.3"
                           EasingFunction="{StaticResource CaptureEasing}"/>
            <DoubleAnimation x:Name="CaptureRotationAnimation"
                           Storyboard.TargetProperty="(UIElement.RenderTransform).(CompositeTransform.Rotation)"
                           From="0"
                           To="180"
                           Duration="0:0:0.3"/>
        </Storyboard>

        <!-- Board entrance animation -->
        <Storyboard x:Name="BoardEntranceAnimation">
            <DoubleAnimation x:Name="BoardOpacityAnimation"
                           Storyboard.TargetName="BoardGrid"
                           Storyboard.TargetProperty="Opacity"
                           From="0.0"
                           To="1.0"
                           Duration="0:0:0.5"/>
            <DoubleAnimation x:Name="BoardScaleAnimation"
                           Storyboard.TargetName="BoardGrid"
                           Storyboard.TargetProperty="(UIElement.RenderTransform).(CompositeTransform.ScaleX)"
                           From="0.8"
                           To="1.0"
                           Duration="0:0:0.5"
                           EasingFunction="{StaticResource BoardEasing}"/>
            <DoubleAnimation x:Name="BoardScaleYAnimation"
                           Storyboard.TargetName="BoardGrid"
                           Storyboard.TargetProperty="(UIElement.RenderTransform).(CompositeTransform.ScaleY)"
                           From="0.8"
                           To="1.0"
                           Duration="0:0:0.5"
                           EasingFunction="{StaticResource BoardEasing}"/>
        </Storyboard>

        <!-- Easing Functions -->
        <CubicEase x:Key="MoveEasing" EasingMode="EaseInOut"/>
        <BackEase x:Key="CaptureEasing" EasingMode="EaseIn" Amplitude="0.5"/>
        <ElasticEase x:Key="BoardEasing" EasingMode="EaseOut" Oscillations="1" Springiness="3"/>
    </UserControl.Resources>

    <Grid x:Name="BoardContainer">
        <Grid x:Name="BoardGrid" 
              Background="{ThemeResource CardBackgroundFillColorDefaultBrush}"
              CornerRadius="12"
              Padding="20"
              RenderTransformOrigin="0.5,0.5">
            
            <!-- Board border with gradient -->
            <Border BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                    BorderThickness="2"
                    CornerRadius="10">
                <Border.Background>
                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                        <GradientStop Color="#F8F8F8" Offset="0"/>
                        <GradientStop Color="#E8E8E8" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
            </Border>
            
            <!-- Chess squares grid -->
            <Grid x:Name="ChessGrid" 
                  Width="560" 
                  Height="560"
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center">
                
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>
                
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
            </Grid>
            
            <!-- Coordinate labels -->
            <Grid x:Name="CoordinateGrid" 
                  Width="560" 
                  Height="560"
                  HorizontalAlignment="Center"
                  VerticalAlignment="Center"
                  IsHitTestVisible="False">
                
                <!-- File labels (a-h) -->
                <StackPanel Orientation="Horizontal" 
                            HorizontalAlignment="Center" 
                            VerticalAlignment="Bottom"
                            Margin="0,0,0,-35">
                    <TextBlock Text="a" FontSize="16" FontWeight="SemiBold" 
                              Foreground="{ThemeResource TextFillColorSecondaryBrush}" 
                              Width="60" TextAlignment="Center"/>
                    <TextBlock Text="b" FontSize="16" FontWeight="SemiBold" 
                              Foreground="{ThemeResource TextFillColorSecondaryBrush}" 
                              Width="60" TextAlignment="Center"/>
                    <TextBlock Text="c" FontSize="16" FontWeight="SemiBold" 
                              Foreground="{ThemeResource TextFillColorSecondaryBrush}" 
                              Width="60" TextAlignment="Center"/>
                    <TextBlock Text="d" FontSize="16" FontWeight="SemiBold" 
                              Foreground="{ThemeResource TextFillColorSecondaryBrush}" 
                              Width="60" TextAlignment="Center"/>
                    <TextBlock Text="e" FontSize="16" FontWeight="SemiBold" 
                              Foreground="{ThemeResource TextFillColorSecondaryBrush}" 
                              Width="60" TextAlignment="Center"/>
                    <TextBlock Text="f" FontSize="16" FontWeight="SemiBold" 
                              Foreground="{ThemeResource TextFillColorSecondaryBrush}" 
                              Width="60" TextAlignment="Center"/>
                    <TextBlock Text="g" FontSize="16" FontWeight="SemiBold" 
                              Foreground="{ThemeResource TextFillColorSecondaryBrush}" 
                              Width="60" TextAlignment="Center"/>
                    <TextBlock Text="h" FontSize="16" FontWeight="SemiBold" 
                              Foreground="{ThemeResource TextFillColorSecondaryBrush}" 
                              Width="60" TextAlignment="Center"/>
                </StackPanel>
                
                <!-- Rank labels (1-8) -->
                <StackPanel Orientation="Vertical" 
                            HorizontalAlignment="Left" 
                            VerticalAlignment="Center"
                            Margin="-35,0,0,0">
                    <TextBlock Text="8" FontSize="16" FontWeight="SemiBold" 
                              Foreground="{ThemeResource TextFillColorSecondaryBrush}" 
                              Height="60" TextAlignment="Center" VerticalAlignment="Center"/>
                    <TextBlock Text="7" FontSize="16" FontWeight="SemiBold" 
                              Foreground="{ThemeResource TextFillColorSecondaryBrush}" 
                              Height="60" TextAlignment="Center" VerticalAlignment="Center"/>
                    <TextBlock Text="6" FontSize="16" FontWeight="SemiBold" 
                              Foreground="{ThemeResource TextFillColorSecondaryBrush}" 
                              Height="60" TextAlignment="Center" VerticalAlignment="Center"/>
                    <TextBlock Text="5" FontSize="16" FontWeight="SemiBold" 
                              Foreground="{ThemeResource TextFillColorSecondaryBrush}" 
                              Height="60" TextAlignment="Center" VerticalAlignment="Center"/>
                    <TextBlock Text="4" FontSize="16" FontWeight="SemiBold" 
                              Foreground="{ThemeResource TextFillColorSecondaryBrush}" 
                              Height="60" TextAlignment="Center" VerticalAlignment="Center"/>
                    <TextBlock Text="3" FontSize="16" FontWeight="SemiBold" 
                              Foreground="{ThemeResource TextFillColorSecondaryBrush}" 
                              Height="60" TextAlignment="Center" VerticalAlignment="Center"/>
                    <TextBlock Text="2" FontSize="16" FontWeight="SemiBold" 
                              Foreground="{ThemeResource TextFillColorSecondaryBrush}" 
                              Height="60" TextAlignment="Center" VerticalAlignment="Center"/>
                    <TextBlock Text="1" FontSize="16" FontWeight="SemiBold" 
                              Foreground="{ThemeResource TextFillColorSecondaryBrush}" 
                              Height="60" TextAlignment="Center" VerticalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Grid>

        <!-- Animated piece for moves -->
        <TextBlock x:Name="AnimatedPiece"
                   FontSize="40"
                   FontWeight="Bold"
                   HorizontalAlignment="Left"
                   VerticalAlignment="Top"
                   Opacity="0"
                   RenderTransformOrigin="0.5,0.5"
                   IsHitTestVisible="False">
            <TextBlock.RenderTransform>
                <TransformGroup>
                    <TranslateTransform/>
                    <CompositeTransform/>
                </TransformGroup>
            </TextBlock.RenderTransform>
        </TextBlock>
    </Grid>
</UserControl>
